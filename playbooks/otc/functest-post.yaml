- hosts: localhost
  tasks:
    # TODO:
    # - clean the resources, which might have been created
    # - revoke the temp token explicitely
    - include_vars: "{{ zuul.executor.work_root }}/.{{ zuul.build }}"

    - name: delete data file
      command: "shred {{ zuul.executor.work_root }}/.{{ zuul.build }}"

    - name: Revoke temporary token
      uri:
      no_log: true
        url: "{{ temp_token.auth_url }}/auth/tokens"
        method: "DELETE"
        headers:
          X-Auth-Token: "{{ temp_token.token }}"
          X-Subject-Token: "{{ temp_token.token }}"
        status_code: 204
